# javaå¤šçº¿ç¨‹æ€»ç»“

##1. è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«

>ä¸€å¥è¯æ€»ç»“å¤šçº¿ç¨‹ï¼š ä¸€æ¡çº¿ç¨‹æ˜¯è¿›ç¨‹ä¸­çš„ä¸€ä¸ªé¡ºåºçš„æ§åˆ¶æµï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹ï¼Œæ¯æ¡çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œèƒ½å¤Ÿæ»¡è¶³ç¨‹åºå‘˜ç¼–å†™é«˜æ•ˆç‡çš„ä»£ç æ¥è¾¾åˆ°å……åˆ†åˆ©ç”¨CPUçš„ç›®çš„ï¼Ÿ
>**è¿›ç¨‹æ˜¯å•¥ï¼Ÿ**ä¸€ä¸ªè¿›ç¨‹åŒ…æ‹¬æ“ä½œç³»ç»Ÿåˆ†é…çš„å†…å­˜ç©ºé—´ã€åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹ã€‚çº¿ç¨‹å¿…é¡»ä¾èµ–è¿›ç¨‹çš„å­˜åœ¨

- è¿›ç¨‹æ˜¯ä»€ä¹ˆ?

  è¿›ç¨‹å°±æ˜¯è®¡ç®—æœºå¼€å¯äº†ä¸€ä¸ªåº”ç”¨ç¨‹åº,æ˜¯ä¸€æ¬¡åº”ç”¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹.å…¸å‹ä¾‹å­å°±æ˜¯windowsä¸‹çš„ä»»åŠ¡ç®¡ç†å™¨çœ‹åˆ°çš„æ¯ä¸€ä¸ªå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹.æ˜¯è®¡ç®—æœºæ‰§è¡Œçš„åŸºæœ¬å•ä½,ä¸€ä¸ªè¿›ç¨‹åŒ…å«å¤šä¸ªçº¿ç¨‹
- çº¿ç¨‹æ˜¯æ’’? 
  
  çº¿ç¨‹æ˜¯å’Œè¿›ç¨‹ç±»ä¼¼çš„ä¸œè¥¿,ä½†æ˜¯çº¿ç¨‹æ›´åŠ çš„è½»é‡çº§,æ˜¯æ›´å°çš„æ‰§è¡Œå•ä½. javaä¸­çº¿ç¨‹å…±äº«**å †**å’Œ**æ–¹æ³•åŒº**,æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±ç‹¬è‡ªçš„**ç¨‹åºè®¡æ•°å™¨,è™šæ‹Ÿæœºæ ˆ,æœ¬åœ°æ–¹æ³•æ ˆ**
  
  ä¸€å¼ å›¾è¡¨æ˜è¿›ç¨‹å’Œçº¿ç¨‹çš„å…³ç³»:![è¿›ç¨‹çº¿ç¨‹åŒºåˆ«](https://diycode.b0.upaiyun.com/photo/2019/ff96fed0e2a354bb16bbc84dcedf503a.png)


****
##ä¸€.å¦‚ä½•Newä¸€ä¸ªæ–°çº¿ç¨‹``
åœ¨javaä¸­è¦æƒ³å®ç°å¤šçº¿ç¨‹ï¼Œæœ‰ä¸¤ç§æ‰‹æ®µï¼Œ
 
 * **ä¸€ç§æ˜¯ç»§æ‰¿Threadç±»ï¼Œ**ï¼ˆè¯¦è§ æˆ‘çš„Interviewé¡¹ç›® threadåŒ…ä¸‹çš„ NewThread1.javaï¼‰
 *  **å¦å¤–ä¸€ç§æ˜¯å®ç°Runableæ¥å£.**ï¼ˆè¯¦è§ æˆ‘çš„Interviewé¡¹ç›® threadåŒ…ä¸‹çš„ NewThread2.javaï¼‰
(å…¶å®å‡†ç¡®æ¥è®²ï¼Œåº”è¯¥æœ‰ä¸‰ç§ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯å®ç°Callableæ¥å£ï¼Œå¹¶ä¸Futureã€çº¿ç¨‹æ± ç»“åˆä½¿ç”¨ï¼Œæ­¤æ–‡è¿™é‡Œä¸è®²è¿™ä¸ªï¼Œæœ‰å…´è¶£çœ‹è¿™é‡Œ) [Javaå¹¶å‘ç¼–ç¨‹ä¸æŠ€æœ¯å†…å¹•:Callableã€Futureã€FutureTaskã€CompletionService ](http://blog.csdn.net/evankaka/article/details/51610635)



>2018.5.11è¡¥å……ï¼Œå…³äºä½¿ç”¨ExecutorServiceã€Callableã€Futureå®ç°æœ‰è¿”å›ç»“æœçš„å¤šçº¿ç¨‹

**ä»£ç å®ç°å¦‚ä¸‹ï¼š**

```java
public class Test {  

    public static void main(String[] args) throws ExecutionException,  InterruptedException {
        System.out.println("----ç¨‹åºå¼€å§‹è¿è¡Œ----");
        Date date1 = new Date();

        int taskSize = 5;
        // åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± 
        ExecutorService pool = Executors.newFixedThreadPool(taskSize);
        // åˆ›å»ºå¤šä¸ªæœ‰è¿”å›å€¼çš„ä»»åŠ¡
        List<Future> list = new ArrayList<Future>();
        for (int i = 0; i < taskSize; i++) {
            Callable c = new MyCallable(i + " ");
            // æ‰§è¡Œä»»åŠ¡å¹¶è·å–Futureå¯¹è±¡
            Future f = pool.submit(c);
            // System.out.println(">>>" + f.get().toString());
            list.add(f);
        }
        // å…³é—­çº¿ç¨‹æ± 
        pool.shutdown();

        // è·å–æ‰€æœ‰å¹¶å‘ä»»åŠ¡çš„è¿è¡Œç»“æœ
        for (Future f : list) {
            // ä»Futureå¯¹è±¡ä¸Šè·å–ä»»åŠ¡çš„è¿”å›å€¼ï¼Œå¹¶è¾“å‡ºåˆ°æ§åˆ¶å°
            System.out.println(">>>" + f.get().toString());
        }

        Date date2 = new Date();
        System.out.println("----ç¨‹åºç»“æŸè¿è¡Œ----ï¼Œç¨‹åºè¿è¡Œæ—¶é—´ã€"
                + (date2.getTime() - date1.getTime()) + "æ¯«ç§’ã€‘");
    }
    static class MyCallable implements Callable<Object> {
        private String taskNum;

        MyCallable(String taskNum) {
            this.taskNum = taskNum;
        }

        public Object call() throws Exception {
            System.out.println(">>>" + taskNum + "ä»»åŠ¡å¯åŠ¨");
            Date dateTmp1 = new Date();
            Thread.sleep(1000);
            Date dateTmp2 = new Date();
            long time = dateTmp2.getTime() - dateTmp1.getTime();
            System.out.println(">>>" + taskNum + "ä»»åŠ¡ç»ˆæ­¢");
            return taskNum + "ä»»åŠ¡è¿”å›è¿è¡Œç»“æœ,å½“å‰ä»»åŠ¡æ—¶é—´ã€" + time + "æ¯«ç§’ã€‘";
        }
    }
}  
```

##äºŒ.å…³äºçº¿ç¨‹çš„çŠ¶æ€æ”¹å˜
**çº¿ç¨‹çš„çŠ¶æ€ç¤ºæ„å›¾ï¼ˆè¯¦ç»†ç‰ˆæœ¬ï¼‰ï¼š**
![Alt text](http://incdn1.b0.upaiyun.com/2016/08/665f644e43731ff9db3d341da5c827e1.png "optional title")

* **æ–°å»ºçŠ¶æ€**ï¼š 
ä½¿ç”¨newå…³é”®å­—æ–°å»ºä¸€ä¸ªThreadç±»æˆ–è€…å…¶å­ç±»çš„å¯¹è±¡åï¼Œè¯¥çº¿ç¨‹å°±å¤„äºæ–°å»ºçŠ¶æ€ï¼Œç¨‹åºè°ƒç”¨startï¼ˆï¼‰æ–¹æ³•ä¹‹å‰çº¿ç¨‹ä¼šä¸€ç›´ä¿æŒæ–°å»ºçŠ¶æ€ã€‚
* **å°±ç»ªçŠ¶æ€**ï¼š
å½“çº¿ç¨‹å¯¹è±¡è°ƒç”¨äº†startï¼ˆï¼‰æ–¹æ³•ä¹‹åï¼Œè¯¥çº¿ç¨‹å°±è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹ä¼šåœ¨å°±ç»ªé˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œç­‰å¾…JVMé‡Œè¾¹çš„çº¿ç¨‹è°ƒåº¦å™¨çš„è°ƒåº¦ã€‚
* **è¿è¡ŒçŠ¶æ€**ï¼š
å¦‚æœå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å– CPU èµ„æºï¼Œå°±å¯ä»¥æ‰§è¡Œ run()ï¼Œæ­¤æ—¶çº¿ç¨‹ä¾¿å¤„äºè¿è¡ŒçŠ¶æ€ã€‚å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹æœ€ä¸ºå¤æ‚ï¼Œå®ƒå¯ä»¥å˜ä¸ºé˜»å¡çŠ¶æ€ã€å°±ç»ªçŠ¶æ€å’Œæ­»äº¡çŠ¶æ€ã€‚
* **é˜»å¡çŠ¶æ€:**
å¦‚æœä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº†sleepï¼ˆç¡çœ ï¼‰ã€suspendï¼ˆæŒ‚èµ·ï¼‰ç­‰æ–¹æ³•ï¼Œå¤±å»æ‰€å ç”¨èµ„æºä¹‹åï¼Œè¯¥çº¿ç¨‹å°±ä»è¿è¡ŒçŠ¶æ€è¿›å…¥é˜»å¡çŠ¶æ€ã€‚åœ¨ç¡çœ æ—¶é—´å·²åˆ°æˆ–è·å¾—è®¾å¤‡èµ„æºåå¯ä»¥é‡æ–°è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚å¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š

  1. ç­‰å¾…é˜»å¡ï¼šè¿è¡ŒçŠ¶æ€ä¸­çš„çº¿ç¨‹æ‰§è¡Œ wait() æ–¹æ³•ï¼Œä½¿çº¿ç¨‹è¿›å…¥åˆ°ç­‰å¾…é˜»å¡çŠ¶æ€ã€‚

  2. åŒæ­¥é˜»å¡ï¼šçº¿ç¨‹åœ¨è·å– synchronized åŒæ­¥é”å¤±è´¥(å› ä¸ºåŒæ­¥é”è¢«å…¶ä»–çº¿ç¨‹å ç”¨)ã€‚

  3. å…¶ä»–é˜»å¡ï¼šé€šè¿‡è°ƒç”¨çº¿ç¨‹çš„ sleep() æˆ– join() å‘å‡ºäº† I/O è¯·æ±‚æ—¶ï¼Œçº¿ç¨‹å°±ä¼šè¿›å…¥åˆ°é˜»å¡çŠ¶æ€ã€‚å½“sleep() çŠ¶æ€è¶…æ—¶ï¼Œjoin() ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è¶…æ—¶ï¼Œæˆ–è€… I/O å¤„ç†å®Œæ¯•ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚
* **æ­»äº¡çŠ¶æ€ï¼š**
ä¸€ä¸ªè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹å®Œæˆä»»åŠ¡æˆ–è€…å…¶ä»–ç»ˆæ­¢æ¡ä»¶å‘ç”Ÿæ—¶ï¼Œè¯¥çº¿ç¨‹å°±åˆ‡æ¢åˆ°ç»ˆæ­¢çŠ¶æ€ã€‚

##ä¸‰.å…³äºçº¿ç¨‹è°ƒåº¦
1. è°ƒæ•´çº¿ç¨‹ä¼˜å…ˆçº§ï¼šJavaçº¿ç¨‹æœ‰ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹ä¼šè·å¾—è¾ƒå¤šçš„è¿è¡Œæœºä¼šã€‚
 
Javaçº¿ç¨‹çš„ä¼˜å…ˆçº§ç”¨æ•´æ•°è¡¨ç¤ºï¼Œå–å€¼èŒƒå›´æ˜¯1~10ï¼ŒThreadç±»æœ‰ä»¥ä¸‹ä¸‰ä¸ªé™æ€å¸¸é‡ï¼š
>
static int MAX_PRIORITY  çº¿ç¨‹å¯ä»¥å…·æœ‰çš„æœ€é«˜ä¼˜å…ˆçº§ï¼Œå–å€¼ä¸º10ã€‚  
static int MIN_PRIORITY   çº¿ç¨‹å¯ä»¥å…·æœ‰çš„æœ€ä½ä¼˜å…ˆçº§ï¼Œå–å€¼ä¸º1ã€‚  
static int NORM_PRIORITY  åˆ†é…ç»™çº¿ç¨‹çš„é»˜è®¤ä¼˜å…ˆçº§ï¼Œå–å€¼ä¸º5ã€‚  

  Threadç±»çš„setPriority()å’ŒgetPriority()æ–¹æ³•åˆ†åˆ«ç”¨æ¥è®¾ç½®å’Œè·å–çº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰é»˜è®¤çš„ä¼˜å…ˆçº§ã€‚ä¸»çº¿ç¨‹çš„é»˜è®¤ä¼˜å…ˆçº§ä¸ºThread.NORM_PRIORITYã€‚çº¿ç¨‹çš„ä¼˜å…ˆçº§æœ‰ç»§æ‰¿å…³ç³»ï¼Œæ¯”å¦‚Açº¿ç¨‹ä¸­åˆ›å»ºäº†Bçº¿ç¨‹ï¼Œé‚£ä¹ˆBå°†å’ŒAå…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ã€‚JVMæä¾›äº†10ä¸ªçº¿ç¨‹ä¼˜å…ˆçº§ï¼Œä½†ä¸å¸¸è§çš„æ“ä½œç³»ç»Ÿéƒ½ä¸èƒ½å¾ˆå¥½çš„æ˜ å°„ã€‚å¦‚æœå¸Œæœ›ç¨‹åºèƒ½ç§»æ¤åˆ°å„ä¸ªæ“ä½œç³»ç»Ÿä¸­ï¼Œåº”è¯¥ä»…ä»…ä½¿ç”¨Threadç±»æœ‰ä»¥ä¸‹ä¸‰ä¸ªé™æ€å¸¸é‡ä½œä¸ºä¼˜å…ˆçº§ï¼Œè¿™æ ·èƒ½ä¿è¯åŒæ ·çš„ä¼˜å…ˆçº§é‡‡ç”¨äº†åŒæ ·çš„è°ƒåº¦æ–¹å¼ã€‚
 
2. çº¿ç¨‹ç¡çœ ï¼šThread.sleep(long millis)æ–¹æ³•ï¼Œä½¿çº¿ç¨‹è½¬åˆ°é˜»å¡çŠ¶æ€ã€‚milliså‚æ•°è®¾å®šç¡çœ çš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚å½“ç¡çœ ç»“æŸåï¼Œå°±è½¬ä¸ºå°±ç»ªï¼ˆRunnableï¼‰çŠ¶æ€ã€‚sleep()å¹³å°ç§»æ¤æ€§å¥½ã€‚
 
3. çº¿ç¨‹ç­‰å¾…ï¼šObjectç±»ä¸­çš„wait()æ–¹æ³•ï¼Œå¯¼è‡´å½“å‰çš„çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ notify() æ–¹æ³•æˆ– notifyAll() å”¤é†’æ–¹æ³•ã€‚è¿™ä¸ªä¸¤ä¸ªå”¤é†’æ–¹æ³•ä¹Ÿæ˜¯Objectç±»ä¸­çš„æ–¹æ³•ï¼Œè¡Œä¸ºç­‰ä»·äºè°ƒç”¨ wait(0) ä¸€æ ·ã€‚
 
4. çº¿ç¨‹è®©æ­¥ï¼šThread.yield() æ–¹æ³•ï¼Œæš‚åœå½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡ï¼ŒæŠŠæ‰§è¡Œæœºä¼šè®©ç»™ç›¸åŒæˆ–è€…æ›´é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ã€‚
 
5. çº¿ç¨‹åŠ å…¥ï¼šjoin()æ–¹æ³•ï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹ç»ˆæ­¢ã€‚åœ¨å½“å‰çº¿ç¨‹ä¸­è°ƒç”¨å¦ä¸€ä¸ªçº¿ç¨‹çš„join()æ–¹æ³•ï¼Œåˆ™å½“å‰çº¿ç¨‹è½¬å…¥é˜»å¡çŠ¶æ€ï¼Œç›´åˆ°å¦ä¸€ä¸ªè¿›ç¨‹è¿è¡Œç»“æŸï¼Œå½“å‰çº¿ç¨‹å†ç”±é˜»å¡è½¬ä¸ºå°±ç»ªçŠ¶æ€ã€‚
 
6.  çº¿ç¨‹å”¤é†’ï¼šObjectç±»ä¸­çš„notify()æ–¹æ³•ï¼Œå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ã€‚å¦‚æœæ‰€æœ‰çº¿ç¨‹éƒ½åœ¨æ­¤å¯¹è±¡ä¸Šç­‰å¾…ï¼Œåˆ™ä¼šé€‰æ‹©å”¤é†’å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ã€‚é€‰æ‹©æ˜¯ä»»æ„æ€§çš„ï¼Œå¹¶åœ¨å¯¹å®ç°åšå‡ºå†³å®šæ—¶å‘ç”Ÿã€‚çº¿ç¨‹é€šè¿‡è°ƒç”¨å…¶ä¸­ä¸€ä¸ª wait æ–¹æ³•ï¼Œåœ¨å¯¹è±¡çš„ç›‘è§†å™¨ä¸Šç­‰å¾…ã€‚ ç›´åˆ°å½“å‰çš„çº¿ç¨‹æ”¾å¼ƒæ­¤å¯¹è±¡ä¸Šçš„é”å®šï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œè¢«å”¤é†’çš„çº¿ç¨‹ã€‚è¢«å”¤é†’çš„çº¿ç¨‹å°†ä»¥å¸¸è§„æ–¹å¼ä¸åœ¨è¯¥å¯¹è±¡ä¸Šä¸»åŠ¨åŒæ­¥çš„å…¶ä»–æ‰€æœ‰çº¿ç¨‹è¿›è¡Œç«äº‰ï¼›ä¾‹å¦‚ï¼Œå”¤é†’çš„çº¿ç¨‹åœ¨ä½œä¸ºé”å®šæ­¤å¯¹è±¡çš„ä¸‹ä¸€ä¸ªçº¿ç¨‹æ–¹é¢æ²¡æœ‰å¯é çš„ç‰¹æƒæˆ–åŠ£åŠ¿ã€‚ç±»ä¼¼çš„æ–¹æ³•è¿˜æœ‰ä¸€ä¸ªnotifyAll()ï¼Œå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚
 æ³¨æ„ï¼šThreadä¸­suspend()å’Œresume()ä¸¤ä¸ªæ–¹æ³•åœ¨JDK1.5ä¸­å·²ç»åºŸé™¤ï¼Œä¸å†ä»‹ç»ã€‚å› ä¸ºæœ‰æ­»é”å€¾å‘ã€‚


## å››ã€å¸¸ç”¨å‡½æ•°è¯´æ˜
1. **sleep(long millis):** åœ¨æŒ‡å®šçš„æ¯«ç§’æ•°å†…è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ä¼‘çœ ï¼ˆæš‚åœæ‰§è¡Œï¼‰

2. **join():**æŒ‡ç­‰å¾…tçº¿ç¨‹ç»ˆæ­¢ã€‚

  **ä½¿ç”¨æ–¹å¼:**ä¸»çº¿ç¨‹ç”Ÿæˆå¹¶èµ·åŠ¨äº†å­çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹éœ€è¦ç­‰å¾…å­çº¿ç¨‹æ‰§è¡Œå®Œæˆä¹‹åå†ç»“æŸï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°join()æ–¹æ³•äº†ã€‚ä¸»çº¿ç¨‹ä¸€å®šä¼šç­‰å­çº¿ç¨‹éƒ½ç»“æŸäº†æ‰ç»“æŸ.
  
  ```java
  public static void main(String[] args) throws InterruptedException {
        System.out.println("main thread start running!");
        Thread thread1=new Thread(new MyRunnable("A"));
        thread1.start();
        thread1.join();
        System.out.println("main thread now is End My dear!");
        //   ç»“æœ: main thread start running!
        //        Aè¿è¡Œ  :  0
        //        Aè¿è¡Œ  :  1
        //        Aè¿è¡Œ  :  2
        //        Aè¿è¡Œ  :  3
        //        Aè¿è¡Œ  :  4
        //        main thread now is End My dear!    }
  ```


3. yield():

  - æš‚åœå½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œå…¶ä»–çº¿ç¨‹ã€‚Thread.yield()æ–¹æ³•ä½œç”¨æ˜¯ï¼šæš‚åœå½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œå…¶ä»–çº¿ç¨‹ã€‚yield()åº”è¯¥åšçš„æ˜¯è®©å½“å‰è¿è¡Œçº¿ç¨‹å›åˆ°å¯è¿è¡ŒçŠ¶æ€ï¼Œä»¥å…è®¸å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„å…¶ä»–çº¿ç¨‹è·å¾—è¿è¡Œæœºä¼šã€‚å› æ­¤ï¼Œä½¿ç”¨yield()çš„ç›®çš„æ˜¯è®©ç›¸åŒä¼˜å…ˆçº§çš„çº¿ç¨‹ä¹‹é—´èƒ½é€‚å½“çš„è½®è½¬æ‰§è¡Œã€‚ä½†æ˜¯ï¼Œå®é™…ä¸­æ— æ³•ä¿è¯yield()è¾¾åˆ°è®©æ­¥ç›®çš„ï¼Œå› ä¸ºè®©æ­¥çš„çº¿ç¨‹è¿˜æœ‰å¯èƒ½è¢«çº¿ç¨‹è°ƒåº¦ç¨‹åºå†æ¬¡é€‰ä¸­
    
     **ç»“è®ºï¼šyield()ä»æœªå¯¼è‡´çº¿ç¨‹è½¬åˆ°ç­‰å¾…/ç¡çœ /é˜»å¡çŠ¶æ€ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œyield()å°†å¯¼è‡´çº¿ç¨‹ä»è¿è¡ŒçŠ¶æ€è½¬åˆ°å¯è¿è¡ŒçŠ¶æ€ï¼Œä½†æœ‰å¯èƒ½æ²¡æœ‰æ•ˆæœã€‚å¯çœ‹ä¸Šé¢çš„å›¾ã€‚**
   - **sleep()å’Œyield()çš„åŒºåˆ«**
     
     sleep()ä½¿å½“å‰çº¿ç¨‹è¿›å…¥åœæ»çŠ¶æ€ï¼Œæ‰€ä»¥æ‰§è¡Œsleep()çš„çº¿ç¨‹åœ¨æŒ‡å®šçš„æ—¶é—´å†…è‚¯å®šä¸ä¼šè¢«æ‰§è¡Œï¼›yield()åªæ˜¯ä½¿å½“å‰çº¿ç¨‹é‡æ–°å›åˆ°å¯æ‰§è¡ŒçŠ¶æ€ï¼Œæ‰€ä»¥æ‰§è¡Œyield()çš„çº¿ç¨‹æœ‰å¯èƒ½åœ¨è¿›å…¥åˆ°å¯æ‰§è¡ŒçŠ¶æ€åé©¬ä¸Šåˆè¢«æ‰§è¡Œã€‚  
     
     sleep() æ–¹æ³•ä½¿å½“å‰è¿è¡Œä¸­çš„çº¿ç¨‹ç¡çœ¼ä¸€æ®µæ—¶é—´ï¼Œè¿›å…¥ä¸å¯è¿è¡ŒçŠ¶æ€ï¼Œè¿™æ®µæ—¶é—´çš„é•¿çŸ­æ˜¯ç”±ç¨‹åºè®¾å®šçš„ï¼Œyield æ–¹æ³•ä½¿å½“å‰çº¿ç¨‹è®©å‡º CPU å æœ‰æƒï¼Œä½†è®©å‡ºçš„æ—¶é—´æ˜¯ä¸å¯è®¾å®šçš„ã€‚å®é™…ä¸Šï¼Œyield()æ–¹æ³•å¯¹åº”äº†å¦‚ä¸‹æ“ä½œï¼šå…ˆæ£€æµ‹å½“å‰æ˜¯å¦æœ‰ç›¸åŒä¼˜å…ˆçº§çš„çº¿ç¨‹å¤„äºåŒå¯è¿è¡ŒçŠ¶æ€ï¼Œå¦‚æœ‰ï¼Œåˆ™æŠŠ CPU  çš„å æœ‰æƒäº¤ç»™æ­¤çº¿ç¨‹ï¼Œå¦åˆ™ï¼Œç»§ç»­è¿è¡ŒåŸæ¥çš„çº¿ç¨‹ã€‚*æ‰€ä»¥yield()æ–¹æ³•ç§°ä¸ºâ€œé€€è®©â€ï¼Œå®ƒæŠŠè¿è¡Œæœºä¼šè®©ç»™äº†åŒç­‰ä¼˜å…ˆçº§çš„å…¶ä»–çº¿ç¨‹* 
     
     å¦å¤–ï¼Œsleep æ–¹æ³•å…è®¸è¾ƒä½ä¼˜å…ˆçº§çš„çº¿ç¨‹è·å¾—è¿è¡Œæœºä¼šï¼Œä½† yield()  æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œå½“å‰çº¿ç¨‹ä»å¤„åœ¨å¯è¿è¡ŒçŠ¶æ€ï¼Œæ‰€ä»¥ï¼Œä¸å¯èƒ½è®©å‡ºè¾ƒä½ä¼˜å…ˆçº§çš„çº¿ç¨‹äº›æ—¶è·å¾— CPU å æœ‰æƒã€‚åœ¨ä¸€ä¸ªè¿è¡Œç³»ç»Ÿä¸­ï¼Œå¦‚æœè¾ƒé«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹æ²¡æœ‰è°ƒç”¨ sleep æ–¹æ³•ï¼Œåˆæ²¡æœ‰å—åˆ° I\O é˜»å¡ï¼Œé‚£ä¹ˆï¼Œè¾ƒä½ä¼˜å…ˆçº§çº¿ç¨‹åªèƒ½ç­‰å¾…æ‰€æœ‰è¾ƒé«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹è¿è¡Œç»“æŸï¼Œæ‰æœ‰æœºä¼šè¿è¡Œã€‚ 


4. setPriority(): æ›´æ”¹çº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚
ã€€ã€€ã€€ã€€MIN_PRIORITY = 1
  ã€€ã€€   NORM_PRIORITY = 5
           MAX_PRIORITY = 10

ç”¨æ³•ï¼š
Thread4 t1 = new Thread4("t1");
Thread4 t2 = new Thread4("t2");
t1.setPriority(Thread.MAX_PRIORITY);
t2.setPriority(Thread.MIN_PRIORITY);

5. interrupt():  
   ä¸è¦ä»¥ä¸ºå®ƒæ˜¯ä¸­æ–­æŸä¸ªçº¿ç¨‹ï¼å®ƒåªæ˜¯çº¿çº¿ç¨‹å‘é€ä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œè®©çº¿ç¨‹åœ¨æ— é™ç­‰å¾…æ—¶ï¼ˆå¦‚æ­»é”æ—¶ï¼‰èƒ½æŠ›å‡ºæŠ›å‡ºï¼Œä»è€Œç»“æŸçº¿ç¨‹ï¼Œä½†æ˜¯å¦‚æœä½ åƒæ‰äº†è¿™ä¸ªå¼‚å¸¸ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹è¿˜æ˜¯ä¸ä¼šä¸­æ–­çš„ï¼
6. wait()  
   
   **Obj.wait()ï¼Œä¸Obj.notify()**å¿…é¡»è¦ä¸synchronized(Obj)ä¸€èµ·ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯wait,ä¸notifyæ˜¯**é’ˆå¯¹å·²ç»è·å–äº†Objé”è¿›è¡Œæ“ä½œ**  
   
   ä»è¯­æ³•è§’åº¦æ¥è¯´å°±æ˜¯Obj.wait(),Obj.notifyå¿…é¡»åœ¨synchronized(Obj){...}è¯­å¥å—å†…ã€‚
   
   ä»åŠŸèƒ½ä¸Šæ¥è¯´waitå°±æ˜¯è¯´çº¿ç¨‹åœ¨è·å–å¯¹è±¡é”åï¼Œä¸»åŠ¨é‡Šæ”¾å¯¹è±¡é”ï¼ŒåŒæ—¶æœ¬çº¿ç¨‹ä¼‘çœ ã€‚ç›´åˆ°æœ‰å…¶å®ƒçº¿ç¨‹è°ƒç”¨å¯¹è±¡çš„notify()å”¤é†’è¯¥çº¿ç¨‹ï¼Œæ‰èƒ½ç»§ç»­è·å–å¯¹è±¡é”ï¼Œå¹¶ç»§ç»­æ‰§è¡Œã€‚
   
   ç›¸åº”çš„notify()å°±æ˜¯å¯¹å¯¹è±¡é”çš„å”¤é†’æ“ä½œã€‚ä½†æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯notify()è°ƒç”¨åï¼Œå¹¶ä¸æ˜¯é©¬ä¸Šå°±é‡Šæ”¾å¯¹è±¡é”çš„ï¼Œè€Œæ˜¯åœ¨ç›¸åº”çš„synchronized(){}è¯­å¥å—æ‰§è¡Œç»“æŸï¼Œè‡ªåŠ¨é‡Šæ”¾é”åï¼ŒJVMä¼šåœ¨wait()å¯¹è±¡é”çš„çº¿ç¨‹ä¸­éšæœºé€‰å–ä¸€çº¿ç¨‹ï¼Œèµ‹äºˆå…¶å¯¹è±¡é”ï¼Œå”¤é†’çº¿ç¨‹ï¼Œç»§ç»­æ‰§è¡Œã€‚è¿™æ ·å°±æä¾›äº†åœ¨çº¿ç¨‹é—´åŒæ­¥ã€å”¤é†’çš„æ“ä½œã€‚
   
   Thread.sleep()ä¸Object.wait()äºŒè€…éƒ½å¯ä»¥æš‚åœå½“å‰çº¿ç¨‹ï¼Œé‡Šæ”¾CPUæ§åˆ¶æƒï¼Œä¸»è¦çš„åŒºåˆ«åœ¨äºObject.wait()åœ¨é‡Šæ”¾CPUåŒæ—¶ï¼Œé‡Šæ”¾äº†å¯¹è±¡é”çš„æ§åˆ¶ã€‚
    
####waitå’ŒsleepåŒºåˆ«

**å…±åŒç‚¹ï¼š** 

  1. ä»–ä»¬éƒ½æ˜¯åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œéƒ½å¯ä»¥åœ¨ç¨‹åºçš„è°ƒç”¨å¤„é˜»å¡æŒ‡å®šçš„æ¯«ç§’æ•°ï¼Œå¹¶è¿”å›ã€‚ 

  2. **wait()å’Œsleep()**éƒ½å¯ä»¥é€šè¿‡interrupt()æ–¹æ³• æ‰“æ–­çº¿ç¨‹çš„æš‚åœçŠ¶æ€ ï¼Œä»è€Œä½¿çº¿ç¨‹ç«‹åˆ»æŠ›å‡ºInterruptedExceptionã€‚ å¦‚æœçº¿ç¨‹Aå¸Œæœ›ç«‹å³ç»“æŸçº¿ç¨‹Bï¼Œåˆ™å¯ä»¥å¯¹çº¿ç¨‹Bå¯¹åº”çš„Threadå®ä¾‹è°ƒç”¨interruptæ–¹æ³•ã€‚å¦‚æœæ­¤åˆ»çº¿ç¨‹Bæ­£åœ¨*wait/sleep/join*ï¼Œåˆ™çº¿ç¨‹Bä¼šç«‹åˆ»æŠ›å‡ºInterruptedExceptionï¼Œåœ¨`catch() {}` ä¸­ç›´æ¥returnå³å¯å®‰å…¨åœ°ç»“æŸçº¿ç¨‹ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒInterruptedExceptionæ˜¯çº¿ç¨‹è‡ªå·±ä»å†…éƒ¨æŠ›å‡ºçš„ï¼Œå¹¶ä¸æ˜¯interrupt()æ–¹æ³•æŠ›å‡ºçš„ã€‚å¯¹æŸä¸€çº¿ç¨‹è°ƒç”¨ interrupt()æ—¶ï¼Œå¦‚æœè¯¥çº¿ç¨‹æ­£åœ¨æ‰§è¡Œæ™®é€šçš„ä»£ç ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹æ ¹æœ¬å°±ä¸ä¼šæŠ›å‡ºInterruptedExceptionã€‚ä½†æ˜¯ï¼Œä¸€æ—¦è¯¥çº¿ç¨‹è¿›å…¥åˆ° wait()/sleep()/join()åï¼Œå°±ä¼šç«‹åˆ»æŠ›å‡ºInterruptedException ã€‚ 


**ä¸åŒç‚¹ï¼š**
  
  1. Threadç±»çš„æ–¹æ³•ï¼šsleep(),yield()ç­‰  Objectçš„æ–¹æ³•ï¼šwait()å’Œnotify()ç­‰ 
  
  2. æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªé”æ¥æ§åˆ¶åŒæ­¥è®¿é—®ã€‚Synchronizedå…³é”®å­—å¯ä»¥å’Œå¯¹è±¡çš„é”äº¤äº’ï¼Œæ¥å®ç°çº¿ç¨‹çš„åŒæ­¥ã€‚ sleepæ–¹æ³•æ²¡æœ‰é‡Šæ”¾é”ï¼Œè€Œwaitæ–¹æ³•é‡Šæ”¾äº†é”ï¼Œä½¿å¾—å…¶ä»–çº¿ç¨‹å¯ä»¥ä½¿ç”¨åŒæ­¥æ§åˆ¶å—æˆ–è€…æ–¹æ³•ã€‚ 
   
  5. waitï¼Œnotifyå’ŒnotifyAllåªèƒ½åœ¨åŒæ­¥æ§åˆ¶æ–¹æ³•æˆ–è€…åŒæ­¥æ§åˆ¶å—é‡Œé¢ä½¿ç”¨ï¼Œè€Œsleepå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨æ‰€ä»¥sleep()å’Œwait()æ–¹æ³•çš„æœ€å¤§åŒºåˆ«æ˜¯ï¼šsleep()ç¡çœ æ—¶ï¼Œä¿æŒå¯¹è±¡é”ï¼Œä»ç„¶å æœ‰è¯¥é”ï¼›è€Œwait()ç¡çœ æ—¶ï¼Œé‡Šæ”¾å¯¹è±¡é”ã€‚ä½†æ˜¯wait()å’Œsleep()éƒ½å¯ä»¥é€šè¿‡interrupt()æ–¹æ³•æ‰“æ–­çº¿ç¨‹çš„æš‚åœçŠ¶æ€ï¼Œä»è€Œä½¿çº¿ç¨‹ç«‹åˆ»æŠ›å‡ºInterruptedExceptionï¼ˆä½†ä¸å»ºè®®ä½¿ç”¨è¯¥æ–¹æ³•ï¼‰ã€‚
  

**sleepï¼ˆï¼‰æ–¹æ³•:**
   
   sleep()ä½¿å½“å‰çº¿ç¨‹è¿›å…¥åœæ»çŠ¶æ€ï¼ˆé˜»å¡å½“å‰çº¿ç¨‹ï¼‰ï¼Œè®©å‡ºCUPçš„ä½¿ç”¨ã€ç›®çš„æ˜¯ä¸è®©å½“å‰çº¿ç¨‹ç‹¬è‡ªéœ¸å è¯¥è¿›ç¨‹æ‰€è·çš„CPUèµ„æºï¼Œä»¥ç•™ä¸€å®šæ—¶é—´ç»™å…¶ä»–çº¿ç¨‹æ‰§è¡Œçš„æœºä¼š;sleep()æ˜¯Threadç±»çš„Static(é™æ€)çš„æ–¹æ³•ï¼›å› æ­¤ä»–ä¸èƒ½æ”¹å˜å¯¹è±¡çš„æœºé”ï¼Œæ‰€ä»¥å½“åœ¨ä¸€ä¸ªSynchronizedå—ä¸­è°ƒç”¨Sleep()æ–¹æ³•æ˜¯ï¼Œçº¿ç¨‹è™½ç„¶ä¼‘çœ äº†ï¼Œä½†æ˜¯å¯¹è±¡çš„æœºé”å¹¶æœ¨æœ‰è¢«é‡Šæ”¾ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®è¿™ä¸ªå¯¹è±¡ï¼ˆå³ä½¿ç¡ç€ä¹ŸæŒæœ‰å¯¹è±¡é”ï¼‰ã€‚
   
 åœ¨sleep()ä¼‘çœ æ—¶é—´æœŸæ»¡åï¼Œè¯¥çº¿ç¨‹ä¸ä¸€å®šä¼šç«‹å³æ‰§è¡Œï¼Œè¿™æ˜¯å› ä¸ºå…¶å®ƒçº¿ç¨‹å¯èƒ½æ­£åœ¨è¿è¡Œè€Œä¸”æ²¡æœ‰è¢«è°ƒåº¦ä¸ºæ”¾å¼ƒæ‰§è¡Œï¼Œé™¤éæ­¤çº¿ç¨‹å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚
   

**waitï¼ˆï¼‰æ–¹æ³•**
   
   wait()æ–¹æ³•æ˜¯Objectç±»é‡Œçš„æ–¹æ³•ï¼›å½“ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°wait()æ–¹æ³•æ—¶ï¼Œå®ƒå°±è¿›å…¥åˆ°ä¸€ä¸ªå’Œè¯¥å¯¹è±¡ç›¸å…³çš„ç­‰å¾…æ± ä¸­ï¼ŒåŒæ—¶å¤±å»ï¼ˆé‡Šæ”¾ï¼‰äº†å¯¹è±¡çš„æœºé”ï¼ˆæš‚æ—¶å¤±å»æœºé”ï¼Œwait(long timeout)è¶…æ—¶æ—¶é—´åˆ°åè¿˜éœ€è¦è¿”è¿˜å¯¹è±¡é”;
   
   å…¶ä»–çº¿ç¨‹å¯ä»¥è®¿é—®;wait()ä½¿ç”¨notifyæˆ–è€…notifyAlllæˆ–è€…æŒ‡å®šç¡çœ æ—¶é—´æ¥å”¤é†’å½“å‰ç­‰å¾…æ± ä¸­çš„çº¿ç¨‹ã€‚wait()å¿…é¡»æ”¾åœ¨synchronized blockä¸­ï¼Œå¦åˆ™ä¼šåœ¨program runtimeæ—¶æ‰”å‡ºâ€java.lang.IllegalMonitorStateExceptionâ€œå¼‚å¸¸.

----
## äº”ã€synchronized æ˜¯å•¥?

- é¦–å…ˆè¯´ä¸€ä¸‹synchronizedç”¨æ³•
  
  1. ä¿®é¥°å®ä¾‹æ–¹æ³•:   **éœ€è¦è·å¾—åˆ›å»ºçš„å®ä¾‹çš„é”æ‰å¯ä»¥è¿è¡Œ**
  2. ä¿®é¥°é™æ€æ–¹æ³•:   é™æ€æ–¹æ³•æ˜¯å±äºå½“å‰ç±»,æ— è®ºæœ‰å¤šå°‘å®ä¾‹,é™æ€æ–¹æ³•only one. **æ‰€ä»¥è°ƒç”¨é™æ€æ–¹æ³•çš„æ—¶å€™åªéœ€è·å–SomeClass.clssçš„é”èµ„æºå°±è¡Œ,å’Œå®ä¾‹æ–¹æ³•è·å–æ¯ä¸ªå®ä¾‹é”èµ„æºä¸å†²çª**
  3. ä¿®é¥°ä»£ç å—: synchronizedä½œç”¨ä»£ç å—,è¿›å…¥ä»£ç å—éœ€è¦è·å–æŒ‡å®šå¯¹åº”çš„é”èµ„æº
- ç»å…¸çš„åŒé‡æ£€æŸ¥çš„å•ä¾‹æ¨¡å¼

  ```java
  public class SingleTonLazy {
	//ä½¿ç”¨volatileå°†è¯¥å¯¹è±¡ç¼–ç¨‹å¤šçº¿ç¨‹é—´å¯è§çš„
	private static volatile SingleTonLazy singleTonLazy = null;

    private SingleTonLazy() {}

	public static SingleTonLazy getInsTance() {
		/*ä¿®æ”¹æˆå¦‚ä¸‹æ–¹å¼ åŒé‡æ£€æŸ¥é”**/
		if (null==singleTonLazy){
			synchronized (SingleTonLazy.class){
				if (null==singleTonLazy){
					singleTonLazy=new SingleTonLazy();
				}
			}
		}
		return singleTonLazy;
	}
}

  ```
  
  æ³¨æ„ç‚¹:
    1. å®ä¾‹ singleTonLazy è¦åŠ ä¸Švolatileå…³é”®å­—. ä¸ºä»€ä¹ˆè¦åŠ ä¸Šå‘¢? è¿™è·ŸJVMå¯¹æŒ‡ä»¤é‡æ’åºç›¸å…³. ç®€è€Œè¨€ä¹‹,å¯¹ä¸€ä¸ªéåŸå­æ“ä½œçš„ä»£ç ,JVMè¦åˆ†æˆå¤šä¸ªå°çš„åŸå­æŒ‡ä»¤å»æ‰§è¡Œ,åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­è¿™äº›å°çš„åŸå­æ“ä½œåœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹é¡ºåºæ˜¯æ²¡åŠæ³•ä¿è¯çš„!
    
      ä¾‹å¦‚è¯­å¥```singleTonLazy=new SingleTonLazy```è¿™æ¡è¯­å¥,å®é™…ä¸ŠJVMæ‰§è¡ŒæŒ‡ä»¤çš„æ—¶å€™æ˜¯åˆ†ä¸‰ä¸ªåŸå­æŒ‡ä»¤.
       
       - ä¸ºsingleTonLazyå®ä¾‹åˆ†é…å†…å­˜ç©ºé—´
       - åˆå§‹åŒ–è¯¥å®ä¾‹çš„æŒ‡ä»¤
       - å°†è¯¥å®ä¾‹æŒ‡å‘å·²åˆ†é…çš„å†…å­˜åœ°å€
      
      **ä½¿ç”¨volatileä½œç”¨:**å„ä¸ªçº¿ç¨‹ä¼šå°†å…±äº«å˜é‡ä»ä¸»å†…å­˜ä¸­æ‹·è´åˆ°å·¥ä½œå†…å­˜ï¼Œç„¶åæ‰§è¡Œå¼•æ“ä¼šåŸºäºå·¥ä½œå†…å­˜ä¸­çš„æ•°æ®è¿›è¡Œæ“ä½œå¤„ç†ã€‚çº¿ç¨‹åœ¨å·¥ä½œå†…å­˜è¿›è¡Œæ“ä½œåä½•æ—¶ä¼šå†™åˆ°ä¸»å†…å­˜ä¸­ï¼Ÿè¿™ä¸ªæ—¶æœºå¯¹æ™®é€šå˜é‡æ˜¯æ²¡æœ‰è§„å®šçš„ï¼Œè€Œé’ˆå¯¹volatileä¿®é¥°çš„å˜é‡ç»™javaè™šæ‹Ÿæœºç‰¹æ®Šçš„çº¦å®šï¼Œçº¿ç¨‹å¯¹volatileå˜é‡çš„ä¿®æ”¹ä¼šç«‹åˆ»è¢«å…¶ä»–çº¿ç¨‹æ‰€æ„ŸçŸ¥ï¼Œå³ä¸ä¼šå‡ºç°æ•°æ®è„è¯»çš„ç°è±¡ï¼Œä»è€Œä¿è¯æ•°æ®çš„â€œå¯è§æ€§â€ã€‚

- synchronizedåœ¨ä¿®é¥°ä»£ç å—çš„æ—¶å€™:**synchronized åŒæ­¥è¯­å¥å—çš„å®ç°ä½¿ç”¨çš„æ˜¯ monitorenter å’Œ monitorexit æŒ‡ä»¤ï¼Œå…¶ä¸­ monitorenter æŒ‡ä»¤æŒ‡å‘åŒæ­¥ä»£ç å—çš„å¼€å§‹ä½ç½®ï¼Œmonitorexit æŒ‡ä»¤åˆ™æŒ‡æ˜åŒæ­¥ä»£ç å—çš„ç»“æŸä½ç½®**

	synchronizedä¿®é¥°æ–¹æ³•çš„æ—¶å€™:**å–å¾—ä»£ä¹‹çš„ç¡®å®æ˜¯ ACC_SYNCHRONIZED æ ‡è¯†ï¼Œè¯¥æ ‡è¯†æŒ‡æ˜äº†è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼ŒJVM é€šè¿‡è¯¥ ACC_SYNCHRONIZED è®¿é—®æ ‡å¿—æ¥è¾¨åˆ«ä¸€ä¸ªæ–¹æ³•æ˜¯å¦å£°æ˜ä¸ºåŒæ­¥æ–¹æ³•ï¼Œä»è€Œæ‰§è¡Œç›¸åº”çš„åŒæ­¥è°ƒç”¨ã€‚**
    
    
## äº”ã€ä¹è§‚é”å’Œæ‚²è§‚é”æ¦‚å¿µ? ä»€ä¹ˆæ˜¯CAS?

é¦–å…ˆå±•ç¤ºä¹è§‚é”å’Œæ‚²è§‚é”çš„ä¾‹å­

```
// ------------------------- æ‚²è§‚é”çš„è°ƒç”¨æ–¹å¼ -------------------------
// synchronized
public synchronized void testMethod() {
	// æ“ä½œåŒæ­¥èµ„æº
}
// ReentrantLock
private ReentrantLock lock = new ReentrantLock(); // éœ€è¦ä¿è¯å¤šä¸ªçº¿ç¨‹ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªé”
public void modifyPublicResources() {
	lock.lock();
	// æ“ä½œåŒæ­¥èµ„æº
	lock.unlock();
}

// ------------------------- ä¹è§‚é”çš„è°ƒç”¨æ–¹å¼ -------------------------
private AtomicInteger atomicInteger = new AtomicInteger();  // éœ€è¦ä¿è¯å¤šä¸ªçº¿ç¨‹ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªAtomicInteger
atomicInteger.incrementAndGet(); //æ‰§è¡Œè‡ªå¢1
```

- **æ‚²è§‚é”:** åº”è¯¥æ˜¯å¾ˆå¸¸è§çš„äº†,å¹³å¸¸ç»å¸¸ç”¨,æ˜¯å°†æ•´ä¸ªèµ„æºçš„é”å¯¹è±¡è·å–,å…¶ä»–å¯¹è±¡å¿…é¡»ç­‰å¾…é”èµ„æºé‡Šæ”¾æ‰å¯ä»¥.
- **ä¹è§‚é”:** ä¹è§‚é”çœ‹ä¸å‡ºæ¥æ˜æ˜¾çš„å ç”¨é”çš„æ“ä½œ. å¸¸è§çš„å°±æ˜¯CASç®—æ³•
____

- **CASç®—æ³•:** (Compare And Swap),æ˜¯ä¸€ç§æ— é”ç®—æ³•,åœ¨ä¸ä½¿ç”¨é”çš„æƒ…å†µä¸‹,ä¹Ÿå°±æ˜¯æ²¡æœ‰çº¿ç¨‹ä¼šå› ä¸ºç­‰å¾…é”èµ„æºè€Œé˜»å¡çš„æƒ…å†µä¸‹,æ˜¯å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨çš„å‘¢? ä¸»è¦åŸå› æ˜¯å› ä¸ºå¦‚ä¸‹ä¸‰æ­¥
  
  * éœ€è¦è¯»å†™çš„å†…å­˜å€¼V
  * ç­‰å¾…æ¯”è¾ƒçš„å€¼A
  * è¦å†™å…¥çš„æ–°å€¼B
    
    > å½“å†™å…¥Bä¹‹å‰,é¦–å…ˆæ¯”è¾ƒAå’ŒVçš„å€¼æ˜¯å¦ç›¸ç­‰,ç›¸ç­‰çš„è¯è¯´æ˜æ²¡æœ‰åˆ«çš„çº¿ç¨‹åœ¨æ‰§è¡Œè¯¥å˜é‡. ç„¶åå†™å…¥æ–°å€¼B,å¦åˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œ.
    
 
## å…­ã€å„ç§é”ğŸ”çš„æ€»ç»“

1. **å•¥æ˜¯è‡ªæ—‹é”? è‡ªé€‚åº”è‡ªæ—‹é”?**
  
  æˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“çš„æ˜¯: çº¿ç¨‹é˜»å¡æˆ–è€…å”¤é†’,æ˜¯éœ€è¦**åˆ‡æ¢CPUçŠ¶æ€**æ¥å®Œæˆ,è¿™ç§åˆ‡æ¢æœ‰æ—¶å€™ä¼šå¾ˆæµªè´¹æ—¶é—´,æ‰€ä»¥ä¸ºäº†è®©æœªè·å–åˆ°é”èµ„æºçš„çº¿ç¨‹'ç­‰ä¸€ä¸‹',æ‰€ä»¥å¯ä»¥é€šè¿‡ä¸æ”¾å¼ƒCPUçš„å ç”¨,ç­‰ä¸‹å†è¯•. ä½†æ˜¯ä¸€èˆ¬ä¼šæœ‰è‡ªæ—‹æ¬¡æ•°çš„ä¸Šé™,è¾¾åˆ°åå°±æŒ‚èµ·æˆ–è€…é˜»å¡çº¿ç¨‹.
   
    
